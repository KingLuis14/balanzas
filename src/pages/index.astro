---
import MainLayout from "@/layout/MainLayout.astro";
import Products from "@/sections/Products-Home.astro";
import HeroHome from "@/sections/Hero-Home.astro";
import Beneficios from "@/sections/Beneficios.astro";
import Navbar from "@/sections/Navbar.astro";
import { wordPressFecth } from "@/utils/WordPressFetch";
import type { Data } from "@/interface/products";
import AboutHome from "@/sections/About-Home.astro";
import TextInfinite from "@/sections/TextInfinite.astro";
import Counters from "@/sections/Counters.astro";

import heroBalanza from "@/assets/balanza-hero.webp";
import heroImg from "@/assets/hero-background.png";
import { getImage } from "astro:assets";

const backgroundHome = await getImage({
  src: heroImg,
  format: "webp",
  width: 400,
  quality: 60,
});



const data: Data = await wordPressFecth({
  query: `
	query NewQuery {
  allProductos {
    nodes {
      productos_balanzas {
        descripcion
        descuento
        id
        oferta
        precio
        imagen {
          srcSet
          mediaItemUrl
        }
        detalles {
          detalle
        }
      }
      slug
    }
  }
}
	`,
});




// console.log(heroBalanza, backgroundHome);
---

<MainLayout
  title="Balanzas del oriente"
  description="Ofrecemos una amplia gama de balanzas de alta calidad y precisiÃ³n para camiones.">
  <Fragment slot="preload">
    <link
      fetchpriority="high"
      rel="preload"
      as="image"
      href={backgroundHome.src}
      type="image/webp"
    />
  </Fragment>

  <Navbar slot="Navbar" />
  <HeroHome image={heroBalanza} backgroundImage={backgroundHome} />
  <Products allProductos={data.allProductos} />
  <Counters />
  <AboutHome />
  <Beneficios />
  <TextInfinite />
</MainLayout>
